---
title: "[ACP考试] - 阿里云内容分发CDN"
catalog: true
date: 2020-09-14 22:20:24
subtitle: ""
header-img: "/img/default.png"
tags:
- 阿里云
catagories:
---

#### CDN的概念

##### CDN产生的背景

随着互联网发展迅速，为了解决“最后一公里的传输质量”问题，而产生了CDN网络技术。由于用户距离物理服务器过远，内容需要进行多次转发，延时高并且不稳定。内容分发网络，就像在全世界各个角落建立数据仓库，借此，用户的请求不再需要访问源站，而是直接访问最近的CDN节点获取。

##### CDN产品介绍

阿里云内容分发网络(Alibaba Cloud Content Delivery Network，简称CDN)将用户源站资源缓存到阿里云遍布全球的加速节点上。当终端用户请求访问和获取这些资源时，无需回源，系统将就近调用CDN节点上已经缓存的资源。

##### CDN原理

1. 请求域名对应IP到Local DNS
2. 请求域名对应IP到Qualified DNS
3. Qualified DNS返回域名对应的IP给Local DNS
4. 请求域名对应的IP给DNS调度系统
5. 返回域名IP给Local DNS
6. 返回域名给用户
7. 请求域名内容到边缘节点
8. 边缘节点如果已缓存则直接返回内容，若未缓存则请求源站

##### CDN功能优势

+ 全球`1500+`节点
+ `120T`带宽能力
+ 分布`70`多个国家和地区
+ 覆盖`6`大洲

稳定、极速、易扩展、性价比

#### CDN的使用

##### 开通CDN产品

1. 开通CDN服务，实名认证后开通CDN服务。
2. 添加加速域名，要求域名通过工信部备案的域名，目前CDN提供控制台和OpenAPI接口。
3. 变更域名的解析，将解析指向CDN系统生成的“CNAME域名”，即完成域名加速接入。

##### 创建加速域名

1. 添加加速域名：域名必须是已备案的
2. 选择加速业务类型：图片下载，流媒体或是全站加速等等
3. 添加源站信息：配支源站类型，端口和加速区域

##### 配置回源策略

+ 阿里云CDN可以设置多个IP、域名为源站，可设置各个源站优先级为主次两档。
+ 源站健康检查是通过四层TCP检查

##### 配置缓存过期时间

该功能可以针对不同目录路径和文件后缀的资源进行缓存服务器行为的设置，用户可以自定义指定资源内容的缓存过期时间规则。支持用户自定义策略优先级。Cache的默认缓存策略。

##### 刷新缓存

有两种强制刷新方式：`URL`或`指定目录`刷新。

##### 查看实时监控数据

可以通过CDN监控台，进入域名管理页面，选择需要设置的域名，点击管理。在数据监控 > 资源监控或实时监控，选择用户想要查看的监控项和指标，点击查询。

##### 适用防盗链功能

防盗链功能基于HTTP协议支持的Referer机制来控制访问。

##### 验证CDN服务

通过Ping命令查看ip，如果是加速节点则说明成功。

##### 其他功能

+ 日志管理
+ 统计分析
+ 性能优化
+ 图片鉴黄

#### CDN的使用场景

+ 静态加速
+ 直播加速
+ 移动应用加速
+ 全站加速
+ 安全加速
+ 大文件加速

##### 静态加速

设置静态资源路径 -> 设置静态文件类型 -> 设置静态文件URL

##### 直播加速

+ 阿里云CDN支持客户不同的直播流输入方式，目前支持推流RTMP/HTTP-FLV，拉流支持RTMP/HTTP-FLV/HLS/HDS
+ 智能调度系统可以将用户请求定位到最优节点
+ 直播中心用于处理对直播流的处理，包括转码率、转分辨率、转音视频编码格式、HLS分片等等。
+ 遍布全球的CDN边缘节点用于实时、快速地响应终端用户的请求。

##### 移动应用加速

+ 防劫持
+ 多终端自适应
+ 动静态加速

##### 计费方式

+ 基础服务：按流量或峰值带宽计费
+ 增值服务：开启HTTPS或全站加速的域名将会额外对HTTPS请求数计费。实时日志和图片鉴黄功能单独收费。

##### 服务等级

服务可用性SLA不低于99.9%。

##### CDN使用限制

+ 域名备份
+ 内容审查：所有接入CDN的域名都要经过内容审查
+ 域名数量限制：每个账户下最多支持加速`50`个域名。如果域名总带宽峰值大于50MB，且业务无风险，则可提交工单增加个数。
+ IP源站：每个加速域名的默认IP源站数量限制为10个IP地址。
+ 刷新操作：URL刷新：2000条/日/每账户；目录刷新：100个/日/每账户。