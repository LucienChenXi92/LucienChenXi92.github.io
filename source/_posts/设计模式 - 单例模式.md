---
title: "设计模式 - 单例设计模式"
catalog: true
date: 2020-02-20 08:51:24
subtitle: "Singleton"
header-img: "/img/default.png"
tags:
- 设计模式
catagories:
---

### 什么是单例模式？
单例模式（Singleton Pattern）是 Java 中最简单的设计模式之一。这种类型的设计模式属于创建型模式，它提供了一种创建对象的最佳方式。这种模式涉及到一个单一的类，该类负责创建自己的对象，同时确保只有单个对象被创建。这个类提供了一种访问其唯一的对象的方式，可以直接访问，不需要实例化该类的对象。

```java
public class Test {

    public static void main(String[] args) {
        SingleSingleton S1 = SingleSingleton.getInstance();
        SingleSingleton S2 = SingleSingleton.getInstance();
        System.out.println("S1 == S2: " + (S1 == S2));

        ConcurrentSingleton S3 = ConcurrentSingleton.getInstance();
        ConcurrentSingleton S4 = ConcurrentSingleton.getInstance();
        System.out.println("S3 == S4: " + (S3 == S4));
    }

}

/**
 * 单线程版本
 */
class SingleSingleton {

    // 私有化实例，保存在方法区内
    private static SingleSingleton instance;
    // 私有构造器，防止外部调用
    private SingleSingleton() {}

    public static SingleSingleton getInstance() {
        // 采用懒汉式创建实例
        if (instance == null) {
            instance = new SingleSingleton();
        }

        return instance;
    }
}

/**
 * 线程安全版本
 */
class ConcurrentSingleton {

    // 私有化实例，保存在方法区内，使用volatile
    private volatile static ConcurrentSingleton instance;
    // 私有构造器，防止外部调用
    private ConcurrentSingleton() {}

    public static ConcurrentSingleton getInstance() {

        // 一旦实例已创建，不会再走同步代码块，优化性能
        if (instance == null) {
            synchronized (ConcurrentSingleton.class) {
                // 双重验证，确保多个线程同时进入第一层非空判断而产生多个实例
                if (instance == null) {
                    instance = new ConcurrentSingleton();
                }
            }
        }
        return instance;
    }
}
```